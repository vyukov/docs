.. _cfx_hair-lable:

Hair
======

Процесс создания волос можно разбить на три основных этапа. 

Groom
_______

**Первым этапом является так называемый груминг (Groom — англ. ухаживать). Его целью является придание прическе персонажа желаемого вида. Процесс заключается в укладке гайд волос (guide — направляющая).**

*Для того чтобы загрумить персонажа нужно:*

	* Запустить Shotgun;
	
	* Открыть Maya 2016;
	
	* Выбрать требуемый таск и создать новую сцену;

	* В новую сцену загрузить всю требуемую для начала работы геометрию (geo, proxy, cloth, cloth_skn) воспользовавшись функцией Load из меню Shotgun;

	* Сгруппировать всю загруженную геометрию согласно утвержденной иерархии;

	* Дублировать геометрию тела персонажа, переименовать ее в “scalp”. Оставить только те полигоны из которых предполагается выращивание волос. Если предполагается рост волос не только из тела персонажа (например волосатая одежда), то следует и из этих частей сделать скальп, объединив их потом в один меш;

	* Сделать развертку UV координат;

	* Выполнить грум согласно техническим требованиям;

	* Отрендерить персонажа с разных ракурсов и загрузить одним изображением в Shotgun > Task >Versions;

	* После утверждения версии сконвертировать гайды каждого дескрипшена в кривые (имя группы кривых должно соответствовать имени дескрипшена с заменой “collection” на “crv”. Например “braid_crv”);

	* Изменить параметры моушн блура, прозрачности и пр. для каждого дескрипшена;

	* Если в среди модификаторов дескришена есть нойз, то его следует забейкать чтоб избежать шевеления волос при анимации;
	
	* Выполнить Shotgun > Publish;
	
	* При первом паблише в описании написать «первый паблиш». Во всех последующих паблишах в описании указать чем эта версия отличается от предыдущей.
	
Anim rig
___________

**Вторым этапом производства волос является создание грум рига (groom_rig). Грум риг это подготовленный к анимации файл, в котором вся необходимая информация собрана таким образом чтоб осталось подключить анимационные кеши этого шота, этого персонажа и во время проигрывания анимации волосы вели себя естественно.**

Для того чтобы начать работу над грум ригом, для того чтобы была возможность проверить все параметры и увидеть результаты всех настроек еще до начала работы в шотах, следует подготовить тестовые анимационные кеши.

*Для того чтобы подготовить тестовые анимационные кеши нужно:*

	* Запустить Shotgun;
	
	* Открыть Maya 2016;
	
	* Выбрать требуемый требуемый ассета открыть паблишеную версию анимационного рига;
	
	* Выбрать все контролы персонажа и подгрузить тестовую анимацию из библиотеки Studio Library (AMG Tools > Animation >Studio Library). На данный момент допустимые тестовые анимации следующие: 390-shot, dance, run. Так же обязательным для выводя является Т-поза, для возврата персонажа в стартовую позицию (никакой анимации из StudioLibrary в данном случае );
	
	* Выполнить скрипт “Export Test Caches”  из shelf-a “CreatureFX” и из предложенных вариантов вывода кешей выбрать тот, который был подгружен ранее из библиотеки;
	
	* После вывода кешей, майа сама закроется.

Groom rig 
__________
	
*Для того чтобы сделать грум риг персонажа нужно:*

	* Запустить Shotgun;

	* Открыть Maya 2016;
	
	* Выбрать требуемый таск и создать новую сцену;

	* Загрузить исходную геометрию, создать утвержденную структуру файла, создать систему волос для каждого дескрипшена. Все эти действия выполняет скрипт “create gRig” из шелфа CreatureFX;
	
	* Настроить параметра каждого дескрипшена, создать все необходимые коллайдеры, констрейны и прочее;

	* Отметить какие из дескрипшенов будут динамическими (Дополнительній атрибут “dynamic” групп “output”);

	* С помощью скрипта “Test Groom Rig” из шелфа CreatureFX подгрузить тестовую анимацию;

	* Внести правки если необходимо;

	* Поменять отображение кривых на отображение Xgen;

	* Сделать плейбласт и загрузить в шотган для утверждения;

	* После утверждения вернуть персонажа в Т-позу запаблишить;

	* При первом паблише в описании написать «первый паблиш». Во всех последующих паблишах в описании указать чем эта версия отличается от предыдущей.

Завершающим этапом работы над волосами будет работа непосредственно в шоте. 

*Для того чтобы отсимулить волосы персонажа в шоте нужно:*

	* Запустить Shotgun;

	* Открыть Maya 2016;
	
	* Выбрать требуемый таск и создать новую сцену;
	
	* Импортировать грум риг в сцену скриптом “import hair”;
	
	* Сделать плейбласт, посмотреть всё ли нормально, внести правки;
	
	* Сделать экспорт скриптом “Export Hair Sim”;

	* Загрузить плейбласт шота в шотган для утверждения;

	*Запаблишить файл сцены.

Cloth:
-------

Процесс создания ткани делится на четыре основных этапа. Моделлинг одежды, создание cloth_sim-a, создание клоз рига, симуляция одежды непосредственно в шоте.

Cloth (Model):
____________________

Для того чтобы создать cloth (model) нужно:

	* Запустить Shotgun;

	* Открыть Maya 2016;

	* Выбрать требуемый таск и создать новую сцену;

	* Отмоделить одежду персонажу согласно всем техническим требованиям;
	
	* Сделать рендеры с разных ракурсов, загрузить в шотган и утвердить;
	
	* Запаблишить файл.


Cloth_sim (Asset):
________________________

Создание группы геометрии cloth_sim. Та геометрия, которая к нам пришла от моделлинга для симуляции не годится. Очень важно создать “удобный” для симула меш. 

Для того чтобы создать cloth_sim (asset) нужно:

	* Запустить Shotgun;

	* Открыть Maya 2016;

	* Выбрать требуемый таск и создать новую сцену;

	* Использую cloth (model) в качестве исходника сделать согласно всем техническим требованиям новую группу геометрии cloth_sim(asset);

	* Утвердить с TD отдела;

	* Запаблишить.


Cloth_Rig (Asset):
____________________

Cloth_Rig - это подготовленный к анимации файл, в котором вся необходимая информация собрана таким образом чтоб осталось подключить анимационные кеши этого шота, этого персонажа и во время проигрывания анимации ткань вела себя как задумано.

Для того чтобы начать работу над клоз_ригом, для того чтобы была возможность проверить все параметры и увидеть результаты всех настроек еще до начала работы в шотах, следует подготовить тестовые анимационные кеши.

Для того чтобы подготовить тестовые анимационные кеши нужно:

	* Запустить Shotgun;

	* Открыть Maya 2016;

	* Выбрать требуемый требуемый ассета открыть паблишеную версию анимационного рига;

	* Выбрать все контролы персонажа и подгрузить тестовую анимацию из библиотеки Studio Library (AMG Tools > Animation >Studio Library). На данный момент допустимые тестовые анимации следующие: 390-shot, dance, run. Так же обязательным для выводя является Т-поза, для возврата персонажа в стартовую позицию (никакой анимации из StudioLibrary в данном случае );

	* Выполнить скрипт “Export Test Caches”  из shelf-a “CreatureFX” и из предложенных вариантов вывода кешей выбрать тот, который был подгружен ранее из библиотеки;

	* После вывода кешей, майа сама закроется.

Для того чтобы создать Cloth_Rig (asset) нужно:

	* Запустить Shotgun;

	* Открыть Maya 2016;
	
	* Выбрать требуемый таск и создать новую сцену;

	* Загрузить исходную геометрию, создать утвержденную структуру файла, создать ткань для каждой геометрии из группы cloth_sim, организовать связи для передачи динамики через группы: input > simulation > output. Все эти действия выполняет скрипт “Create Cloth Rig” из шелфа CreatureFX;

	* Настроить параметра каждого куска ткани, создать все необходимые коллайдеры, констрейны и прочее;

	* С помощью скриптов  (Change Animation To...) из шелфа CreatureFX подгрузить тестовую анимацию;

	* Внести правки если необходимо;

	* Назначить на разные куски ткани lambert-ы разного цвета для лучшего обнаружения проникновений во время симуляций;

	* Сделать плейбласт и загрузить в шотган для утверждения;

	* После утверждения вернуть персонажа в Т-позу запаблишить;

	* При первом паблише в описании написать «первый паблиш». Во всех последующих паблишах в описании указать чем эта версия отличается от предыдущей.


**Почти последним этапом работы над симуляцией ткани будет работа непосредственно в шоте.**

Для того чтобы отсимулить одежду для персонажа в шоте нужно:

	* Запустить Shotgun;

	* Открыть Maya 2016;

	* Выбрать требуемый таск и создать новую сцену;

	* Импортировать клоз риг в сцену скриптом “Full Simulation”;

	* Скрипт попытается провести симуляцию до конца сам, но в 90% случаев приходится останавливать скрипт и вносить коррективы;

	* Сделать плейбласт, посмотреть всё ли нормально, внести правки;

	* Экспортировать группу Output > Cloth с помощью Cache > Alembic Cache > Export Selection To Alembic в папку шота fx > publish ...

	* Загрузить плейбласт шота в шотган для утверждения;

	* Запаблишить файл сцены.


*К сожалению полностью избавится от проникновений одежды очень сложно. Поэтому иногда нужно руками вытащить тот или иной проникший участок одежды.*

Для того чтобы поправить уже выведенные кеи одежды нужно выполнить следующие действия:

	* После того как алембик файл был экспортирован нужно воспользоваться скриптом “Tweak Simulation”. Майа создаст новый файл и загрузит в него кеши, которые нужно исправить.

	* Внести правки в симуляцию.

	* Экспортировать группу Output > Cloth с помощью Cache > Alembic Cache > Export Selection To Alembic в папку шота fx > publish …
